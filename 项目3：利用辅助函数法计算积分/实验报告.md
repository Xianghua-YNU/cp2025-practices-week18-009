      
# 实验报告：利用辅助函数法计算积分

**学生姓名：** [余维] 

**学号：** [20231050005] 

**完成日期：** [2025/6/25]

## 一、实验目的
利用辅助函数法计算积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$，导出由 0 到 1 之间均匀分布随机数产生满足权重函数 $p(x) = {1\over2\sqrt{x}}$ 分布的随机数公式，抽取 $N = 1000000$ 个随机数据点估计积分，并利用公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 估计积分结果的统计误差。

## 二、实验原理
### 2.1 积分计算原理
阐述辅助函数法计算积分的原理，解释目标积分 $I = \int_0^1 {x^{-1/2}\over e^x + 1} d x$ 以及权重函数 $p(x) = {1\over2\sqrt{x}}$ 的意义和作用。

2.1 积分计算原理
辅助函数法的核心思想是使用一个已知概率分布（权重函数）来优化积分计算过程。给定权重函数描述了x取不同值时的概率分布特征。通过将原始积分转化为权重函数下的期望值形式，可以更高效地计算积分值。

具体来说，原始积分可以重新表达为：在权重函数定义的分布下，计算"2除以(e的x次方加1)"的平均值。这种方法显著提高了计算效率，因为权重函数选择的分布更符合被积函数的特性。

2.2 随机数生成原理
我们使用逆变换法生成服从权重函数分布的随机数：

首先计算权重函数的累积分布函数，该函数表示随机变量小于等于某值的概率

累积分布函数的值域为[0,1]，正好对应均匀分布的范围

通过求解累积分布函数的反函数，得到生成公式：均匀随机数的平方

2.3 误差估计原理
蒙特卡罗方法的精度随样本量增加而提高：

统计误差与样本量的平方根成反比

方差计算基于函数值的平方均值减去均值的平方

最终误差估计为方差除以样本量后再开平方

### 2.2 随机数生成原理
详细推导由 0 到 1 之间均匀分布随机数产生满足 $p(x)$ 分布的随机数的公式，给出推导过程。

2.2 随机数生成原理
我们使用逆变换法生成服从权重函数分布的随机数：

首先计算权重函数的累积分布函数，该函数表示随机变量小于等于某值的概率

累积分布函数的值域为[0,1]，正好对应均匀分布的范围

通过求解累积分布函数的反函数，得到生成公式：均匀随机数的平方

### 2.3 误差估计原理
解释公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 和 ${\rm var}f = \langle f^2\rangle - \langle f\rangle^2$ 的含义和使用方法。

2.3 误差估计原理
蒙特卡罗方法的精度随样本量增加而提高：

统计误差与样本量的平方根成反比

方差计算基于函数值的平方均值减去均值的平方

最终误差估计为方差除以样本量后再开平方

## 三、实验环境
### 3.1 硬件环境
- 计算机型号：[Dell XPS 15]
- CPU：[Intel Core i7-11800H]
- 内存：[32GB]

### 3.2 软件环境
- 操作系统：[Windows 11]
- 编程语言：[Python 3.9]
- 开发工具：[Jupyter Notebook]

## 四、实验步骤
### 4.1 随机数生成公式实现
给出推导出的随机数生成公式，并编写代码实现该公式，附上关键代码片段。
```python
# 此处填写生成满足 p(x) 分布随机数的代码示例

import numpy as np

# 设置样本量
N = 1000000

# 生成基础均匀分布随机数
uniform_randoms = np.random.rand(N)

# 通过平方变换得到目标分布的随机数
transformed_randoms = uniform_randoms**2
```

### 4.2 积分估计
编写代码抽取 $N = 1000000$ 个随机数据点并估计积分值，附上关键代码片段。
```python
# 此处填写积分估计的代码示例

# 计算函数值：2/(e^x + 1)
function_values = 2 / (np.exp(transformed_randoms) + 1)

# 计算积分估计值（函数值的平均值）
integral_estimate = np.mean(function_values)
```

### 4.3 误差估计
根据公式 $\sigma=\frac{\sqrt{{\rm var}f}}{\sqrt{N}}$ 编写代码估计积分结果的统计误差，附上关键代码片段。
```python
# 此处填写误差估计的代码示例

# 计算函数值的平方
squared_values = function_values**2

# 计算方差（平方均值减去均值的平方）
variance = np.mean(squared_values) - integral_estimate**2

# 计算标准误差
standard_error = np.sqrt(variance / N)
```

## 五、实验结果
### 5.1 积分估计结果
记录程序运行得到的积分估计值，并与预期结果 0.84 进行对比。
**积分估计值：** [0.838822]

### 5.2 误差估计结果
记录程序运行得到的统计误差值。
**统计误差：** [0.000407]

## 六、实验结论
总结实验结果，判断是否成功完成实验目的，对实验过程和结果进行评价，并提出改进建议。
目标达成情况：
成功实现了辅助函数法计算复杂积分，得到的结果0.838822与理论值0.84高度吻合，验证了方法的有效性。

结果可靠性：
统计误差0.000407表明估计精度较高，且理论值0.84落在置信区间内，证明计算过程可靠。

优化建议：

增加样本量至1000万可进一步降低统计误差

探索其他权重函数可能获得更小的方差

结合分层抽样技术提高计算效率

添加并行计算加速大规模样本处理
        
